<div class="container-fluid">
  <div class="row">
    <div class="col">
      <app-pagination 
        *ngIf="(planItemState$ | async).pagination && 
          (planItemState$ | async).pagination.pageSize > 14 && 
          (planItemState$ | async).pagination.pageCount > 1"
        class="float-right"
        [showInfo]="false"
        [pagination]="(planItemState$ | async).pagination"
        (pageChange)="loadPlanItemsOnPage($event)">
      </app-pagination>
    </div>
  </div>

  <div class="row">
    <div class="col">
        <table class="table table-bordered">
            <thead>
              <tr>
                <th scope="col">Šifra naloga</th>
                <th scope="col">Vrsta proizvodnje</th>
                <th scope="col">Šifra artikla</th>
                <th scope="col">Naziv artikla</th>
                <th scope="col">EM</th>
                <th scope="col">ERP količina</th>
                <th scope="col">Datum ERP od</th>
                <th scope="col">Datum ERP do</th> 
                <th scope="col"></th>   
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let planItem of (planItemState$ | async).entities">
                <th scope="row">{{ planItem.code }}</th>
                <td></td>
                <td>{{ planItem.product.code }}</td>
                <td>{{ planItem.product.name }}</td>
                <td>{{ planItem.measurementUnit.code }}</td>
                <td>{{ planItem.quantity }}</td>
                <td>{{ planItem.limitDateFrom | date:'short' }}</td>
                <td>{{ planItem.limitDateTo | date:'short' }}</td> 
                <td><dx-button
                  class="btn btn-primary btn-sm"
                  text="Planiraj nalog"
                  (onClick)="showInfo(planItem.id)"></dx-button></td>
              </tr>
            </tbody>
          </table>
    </div>
  </div>
  <div class="d-flex justify-content-between">
      <app-page-length [default]="10" (change)="changePageLength($event)" style="min-width: 500px"></app-page-length>
      <app-pagination
      [pagination]="(planItemState$ | async).pagination"
      (pageChange)="loadPlanItemsOnPage($event)"></app-pagination>

  </div>

</div>







<!-- <p>
  planitem-list works!
</p> -->
<!-- {{ (planItemState$ | async).loading }} -->

<!-- <div *ngFor="let planItem of (planItemState$ | async).entities">
  {{ planItem.code }}
</div> -->






<dx-data-grid
    id="gridContainer"
    [dataSource]="(planItemState$ | async).entities">
    <dxo-filter-row
        [visible]="true">
        <!-- applyFilter="onClick"> -->
    </dxo-filter-row>    
    <dxi-column dataField="code" caption="Šifra naloga"></dxi-column>
    <dxi-column dataField="" caption="Vrsta proizvodnje"></dxi-column>
    <dxi-column dataField="product.code" caption="Šifra artikla"></dxi-column>
    <dxi-column dataField="product.name" caption="Naziv artikla"></dxi-column>
    <dxi-column dataField="measurementUnit.code" caption="EM"></dxi-column>
    <dxi-column dataField="quantity" caption="ERP količina"></dxi-column>
    <dxi-column dataField="limitDateFrom" caption="Datum ERP od"></dxi-column>
    <dxi-column dataField="limitDateTo" caption="Datum ERP do"></dxi-column>
    <dxi-column dataField="" caption="Dodaj v delovni nalog"><dx-button
        class="btn btn-primary btn-sm"
        text="Planiraj nalog"
        (onClick)="showInfo(planItem.id)"></dx-button></dxi-column>
    <dxo-remote-operations
        [sorting]="true"
        [paging]="true">
    </dxo-remote-operations>
    <dxo-paging [pageSize]="12"></dxo-paging>
    <dxo-pager
        [showPageSizeSelector]="true"
        [allowedPageSizes]="[8, 12, 20]"
    ></dxo-pager>
</dx-data-grid>



<div id="popup">
  <!-- <h1>Employees</h1> -->
  <!-- <ul>
      <li *ngFor="let planItem of (planItemState$ | async).entities let id = index">
          <img [src]=""/><br/>
          <i>{{ planItem.code }} => {{ planItem.product.name }}</i><br/>
          <dx-button
              class="button-info"
              text="Details"
              (onClick)="showInfo(planItem.id)">
          </dx-button>
      </li>
  </ul> -->
  <dx-popup
      class="popup"
      [width]="300"
      [height]="300"
      [showTitle]="true"
      title="Information"
      [dragEnabled]="false"
      [closeOnOutsideClick]="true"
      [(visible)]="popupVisible">
      <div *dxTemplate="let data of 'content'">
        
        <div class="card-deck">
          <!-- <div class="card-header"></div> -->
          <div class="card-body">
              <h5 class="card-title"></h5>
              <p>
                Šifra naloga:
                <span>{{ code }}</span>
                <span>Test</span>
            </p>
            <p>
                Vrsta proizvodnje:
                <span>Test</span>
            </p>
            <p>
                Artikel:
                <span>[100]</span>
                <span>name</span>
            </p>
            <p>
                Hire Date:
                <span>Test</span>
            </p>
            <p>
                Position:
                <span>Test</span>
            </p>
                <button type="button" class="btn btn-primary">Potdri</button>
                <button type="button" class="btn btn-secondary">Prekliči</button>
          </div>
        </div>  
        <!-- <p>
              Full Name:
              <span>Test</span>
              <span>Test</span>
          </p>
          <p>
              Birth Date:
              <span>Test</span>
          </p>
          <p>
              Address:
              <span>Test</span>
          </p>
          <p>
              Hire Date:
              <span>Test</span>
          </p>
          <p>
              Position:
              <span>Test</span>
          </p> -->

          
      </div>
  </dx-popup>
</div>